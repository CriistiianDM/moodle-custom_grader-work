'use strict';define(['jquery','local_customgrader/bootstrap','local_customgrader/sweetalert','local_customgrader/jqueryui'],function(a){return{init:function init(){function f(o){a.ajax({type:'POST',data:{type:'update_grade_items',course:o},url:'managers/ajax_processing.php',async:!1,success:function success(r){'1'==r?console.log('update ok'):console.log('update fail')},dataType:'text',cache:'false',error:function error(r){console.log(r)}})}function g(o){var p=!1,q=o.val();return 5<q||0>q?(swal({title:'Ingrese un valor valido, entre 0 y 5. \n\rUsted ingres\xF3: '+q,html:!0,type:'warning',confirmButtonColor:'#d51b23'}),o.val(n),p=!1):''==q&&''!=n?(o.val('0'),p=!0):''==q&&''==n||q==n?p=!1:p=!0,p}function h(){a('.topleft').attr('colspan','3'),a('.cat').each(function(){var o=a(this).children().next('.text');o.attr('disabled',!0),o.css('font-weight','bold')}),a('.course').each(function(){var o=a(this).children().next('.text');o.attr('disabled',!0),o.css('font-weight','bold'),o.css('font-size',16)})}function j(o){a('#user-grades').children().children().each(function(){a(this).attr('data-uid')!=void 0&&k(a(this).attr('data-uid'),o)&&a(this).attr('class','ases')})}function k(o,p){for(var q=0;q<p.length;q++)if(p[q].split('_')[1]===o)return!0;return!1}function l(){var o=[];return a('#students-ases').children().each(function(){o.push(a(this).attr('id'))}),o}function m(){for(var q,o=window.location.search.split('&'),p=0;p<o.length;p++)if(q=o[p].split('='),'?id'==q[0]||'id'==q[0]){var r=q[1];return r}}var n;a(document).ready(function(){var o=l();j(o),a('#wizard_button').click(function(){a('.gradeparent').removeClass('sticky-table sticky-headers sticky-ltr-cells'),a('table').removeClass('table table-striped'),a('tbody > tr ').each(function(){a(this)[0].hasAttribute('data-uid')||a(this).removeClass('sticky-row')}),a('.heading').removeClass('sticky-row'),a('.heading:first-child').removeClass('sticky-cell'),a('.header.user.cell.c0').removeClass('sticky-cell')}),h(),0!=a('.gradingerror').length&&swal({title:'Recalculando \xEDtems.',text:'Debido al proceso de actualizaci\xF3n de moodle se debe realizar este paso.\nGracias por su paciencia \nDe seguir presentando este problema, por favor dirigirse a la configuraci\xF3n de calificaciones de moodle',type:'warning',showCancelButton:!1,confirmButtonClass:'btn-danger',confirmButtonText:'Continuar',closeOnConfirm:!1},function(){f(m()),location.reload()})}),a(document).on('blur','.text',function(){if(g(a(this))){var o=a(this).attr('id').split('_'),p=o[1],q=o[2],r=a(this).val(),s=m();a.ajax({type:'POST',data:{user:p,item:q,finalgrade:r,course:s},url:'managers/ajax_processing.php',async:!1,success:function success(u){var v=u.nota;!0==v?console.log('Nota actualizada'):swal('Error','Error al actualizar la nota','error')},dataType:'json',cache:'false',error:function error(u){console.log(u)}})}}),a(document).on('focus','.text',function(){n=a(this).val()}),a(document).on('keypress','.text',function(o){var p=document.all?o.keyCode:o.which;if(8==p||46==p)return!0;var q=/[0-9]/,r=String.fromCharCode(p);return q.test(r)}),a(document).on('click','.reload',function(){location.reload()})}}});